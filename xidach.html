<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üÉè X√¨ D√°ch - Mini Casino</title>
  <style>
    :root {
      --bg-dark: #0f1724;
      --panel: #1e293b;
      --accent: #06b6d4;
      --accent2: #7c3aed;
      --text: #f1f5f9;
      --muted: #94a3b8;
    }

    * { box-sizing: border-box; font-family: "Inter", sans-serif; }

    body {
      margin: 0;
      background: radial-gradient(circle at top, #1e293b, #0f1724);
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 30px 10px;
    }

    .back-btn {
      position: absolute;
      top: 20px;
      left: 20px;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      border: none;
      color: white;
      padding: 10px 18px;
      font-size: 15px;
      font-weight: 600;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .back-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 14px rgba(0,0,0,0.5); }

    h1 {
      font-size: 32px;
      margin-top: 80px;
      margin-bottom: 16px;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      text-align: center;
    }

    .balance {
      background: rgba(255,255,255,0.05);
      padding: 12px 24px;
      border-radius: 12px;
      font-weight: bold;
      margin-bottom: 30px;
    }

    .table {
      background: var(--panel);
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.5);
      width: 340px;
      text-align: center;
    }

    .section { margin-bottom: 20px; }
    .label { font-weight: bold; margin-bottom: 6px; color: var(--muted); }

    .cards {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .card {
      width: 60px;
      height: 80px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 20px;
      transition: transform 0.2s ease, background 0.3s ease;
    }

    .card.red { color: #dc2626; }
    .card.black { color: #0f1724; }

    .hidden-card {
      background: linear-gradient(135deg, #4b5563, #1f2937);
      color: transparent;
      position: relative;
    }
    .hidden-card::after {
      content: "üÇ†";
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      color: #e2e8f0;
    }

    .controls {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    input {
      width: 100px;
      text-align: center;
      padding: 6px;
      border-radius: 8px;
      border: 1px solid #475569;
      background: #0f1724;
      color: white;
      font-weight: bold;
    }

    button {
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      border: none;
      color: white;
      padding: 10px 16px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    button:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.4); }

    #message { margin-top: 16px; font-weight: 700; font-size: 18px; }
    .win { color: #22c55e; }
    .lose { color: #ef4444; }
    .draw { color: #eab308; }
  </style>
</head>

<body>
  <button class="back-btn" onclick="window.location.href='index.html'">üè† Trang Ch√≠nh</button>

  <h1>üÉè X√¨ D√°ch (Blackjack)</h1>
  <div class="balance">üí∞ S·ªë d∆∞: <span id="balance">0</span> ‚Ç´</div>

  <div class="table">
    <div class="section">
      <div class="label">Nh√† C√°i</div>
      <div class="cards" id="dealer"></div>
    </div>

    <div class="section">
      <div class="label">Ng∆∞·ªùi Ch∆°i</div>
      <div class="cards" id="player"></div>
    </div>

    <div class="controls">
      <input type="number" id="bet" value="10000" min="1000" step="1000" />
      <button id="deal">üé≤ Chia</button>
      <button id="hit" disabled>‚ûï R√∫t</button>
      <button id="stand" disabled>‚úã D·ª´ng</button>
    </div>

    <div id="message"></div>
  </div>

  <script>
    let balance = Number(localStorage.getItem('tx_balance')) || 200000;
    const balEl = document.getElementById('balance');
    const betEl = document.getElementById('bet');
    const dealerEl = document.getElementById('dealer');
    const playerEl = document.getElementById('player');
    const msgEl = document.getElementById('message');

    const dealBtn = document.getElementById('deal');
    const hitBtn = document.getElementById('hit');
    const standBtn = document.getElementById('stand');

    let deck = [], dealer = [], player = [];
    let bet = 0, roundActive = false, hiddenCard = null, dealerHiddenShown = false;

    balEl.textContent = balance.toLocaleString('vi-VN');

    function createDeck() {
      const suits = ['‚ô†','‚ô•','‚ô¶','‚ô£'];
      const values = ['A','2','3','4','5','6','7','8','9','10','J','Q','K'];
      deck = [];
      for (let s of suits) for (let v of values) deck.push({value: v, suit: s});
      deck.sort(() => Math.random() - 0.5);
    }

    function cardValue(card) {
      if (['J','Q','K'].includes(card.value)) return 10;
      if (card.value === 'A') return 11;
      return Number(card.value);
    }

    function calc(hand) {
      let total = hand.reduce((sum, c) => sum + cardValue(c), 0);
      let aces = hand.filter(c => c.value === 'A').length;
      while (total > 21 && aces > 0) {
        total -= 10;
        aces--;
      }
      return total;
    }

    function colorBySuit(s) {
      return (s === '‚ô•' || s === '‚ô¶') ? 'red' : 'black';
    }

    function renderDealer(hideSecond = true) {
      dealerEl.innerHTML = '';
      dealer.forEach((c, i) => {
        const div = document.createElement('div');
        if (i === 1 && hideSecond && !dealerHiddenShown) {
          div.className = 'card hidden-card';
        } else {
          div.className = `card ${colorBySuit(c.suit)}`;
          div.textContent = c.value + c.suit;
        }
        dealerEl.appendChild(div);
      });
    }

    function renderPlayer() {
      playerEl.innerHTML = '';
      player.forEach(c => {
        const div = document.createElement('div');
        div.className = `card ${colorBySuit(c.suit)}`;
        div.textContent = c.value + c.suit;
        playerEl.appendChild(div);
      });
    }

    function updateBalance(amount) {
      balance += amount;
      localStorage.setItem('tx_balance', balance);
      balEl.textContent = balance.toLocaleString('vi-VN');
    }

    function showMessage(text, cls = '') {
      msgEl.className = cls;
      msgEl.textContent = text;
    }

    function endRound(result) {
      roundActive = false;
      hitBtn.disabled = true;
      standBtn.disabled = true;
      dealBtn.disabled = false;
      dealerHiddenShown = true;
      renderDealer(false);

      if (result === 'win') {
        showMessage('üéâ B·∫°n th·∫Øng!', 'win');
        updateBalance(bet);
      } else if (result === 'lose') {
        showMessage('üí∏ B·∫°n thua!', 'lose');
        updateBalance(-bet);
      } else {
        showMessage('ü§ù H√≤a!', 'draw');
      }
    }

    dealBtn.onclick = () => {
      bet = Number(betEl.value);
      if (bet <= 0 || bet > balance) {
        alert('S·ªë ti·ªÅn c∆∞·ª£c kh√¥ng h·ª£p l·ªá!');
        return;
      }

      createDeck();
      dealer = [deck.pop(), deck.pop()];
      player = [deck.pop(), deck.pop()];
      dealerHiddenShown = false;

      renderDealer(true);
      renderPlayer();
      showMessage('');
      roundActive = true;

      dealBtn.disabled = true;
      hitBtn.disabled = false;
      standBtn.disabled = false;

      if (calc(player) === 21) endRound('win');
    };

    hitBtn.onclick = () => {
      if (!roundActive) return;
      player.push(deck.pop());
      renderPlayer();
      const total = calc(player);
      if (total > 21) endRound('lose');
    };

    standBtn.onclick = () => {
      if (!roundActive) return;
      dealerHiddenShown = true;
      renderDealer(false);

      while (calc(dealer) < 17) {
        dealer.push(deck.pop());
        renderDealer(false);
      }

      const p = calc(player);
      const d = calc(dealer);
      if (d > 21 || p > d) endRound('win');
      else if (d < p) endRound('win');
      else if (d > p) endRound('lose');
      else endRound('draw');
    };
  </script>
</body>
</html>
